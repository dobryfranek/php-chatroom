
<?php
session_start();  // Start the session

// Dummy credentials for demo purposes (in a real app, use a database)
$valid_username = 'test';  
$valid_password = '123'; 

// If this is a login attempt
if (isset($_POST['action']) && $_POST['action'] === 'login') {
    $username = $_POST['username'] ?? '';
    $password = $_POST['password'] ?? '';

    // Validate credentials
    if ($username === $valid_username && $password === $valid_password) {
        $_SESSION['user'] = $username;  // Set the session
        echo 'Logged in successfully!';
        exit();
    } else {
        echo 'Invalid credentials. Please try again.';
        exit();
    }
}

// If not logged in, treat as "anonymous"
if (!isset($_SESSION['user'])) {
    $_SESSION['user'] = 'anonymous';  // Default to "anonymous"
}

// Handle data posting
$data = $_POST['data'] ?? '';

// Process the data (just echo for now)
echo "From: " . $_SESSION['user'] . " â€” " . $data;
?>











<button id="loginBtn">Login</button>

<!-- Form for posting data -->
<form id="postForm" action="post.php" method="POST" style="display: none;">
    <label for="data">Enter some data:</label>
    <input type="text" id="data" name="data" required><br>
    <input type="submit" value="Post Data">
</form>

<script>
document.getElementById('loginBtn').addEventListener('click', function() {
    // Show a prompt to enter username and password
    let username = prompt("Enter your username:");
    let password = prompt("Enter your password:");

    if (username && password) {
        // Send login credentials to the server via Fetch
        fetch('post.php', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: new URLSearchParams({
                username: username,
                password: password,
                action: 'login'  // Indicate that this is a login request
            })
        })
        .then(response => response.text())
        .then(data => {
            if (data === 'Logged in successfully!') {
                alert('Login successful!');
                document.getElementById('postForm').style.display = 'block';  // Show the form after login
            } else {
                alert('Login failed: ' + data);
            }
        });
    } else {
        alert('Please enter both username and password!');
    }
});
</script>
